(function(t){function e(e){for(var s,i,o=e[0],c=e[1],l=e[2],d=0,f=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);u&&u(e);while(f.length)f.shift()();return n.push.apply(n,l||[]),r()}function r(){for(var t,e=0;e<n.length;e++){for(var r=n[e],s=!0,o=1;o<r.length;o++){var c=r[o];0!==a[c]&&(s=!1)}s&&(n.splice(e--,1),t=i(i.s=r[0]))}return t}var s={},a={app:0},n=[];function i(e){if(s[e])return s[e].exports;var r=s[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=s,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(r,s,function(e){return t[e]}.bind(null,s));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;n.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var s=r("2b0e"),a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("nav",[r("div",{staticClass:"container"},[r("div",[t._v(t._s(t.sitename))]),r("button",{staticClass:"cart-btn",attrs:{disabled:!t.hasItemInCart},on:{click:function(e){return t.displayCart(!0)}}},[t._v("£"+t._s(t.cartTotal)),r("i",{staticClass:"fas fa-shopping-basket"})])])]),r("div",{staticClass:"container filters"},[r("div",{staticClass:"filters-container"},[r("span",{staticClass:"name"},[t._v("Sort by:")]),r("div",{staticClass:"filters-selection"},t._l(t.filters,(function(e,s){return r("button",{key:s,class:{active:t.isSelectedFilter(e)},on:{click:function(r){t.selectedFilter=e}}},[t._v(t._s(e))])})),0)]),r("div",{staticClass:"filters-container"},[r("div",{staticClass:"filters-selection"},t._l(t.orderBy,(function(e,s){return r("button",{key:s,class:{active:t.isSelectedOrder(e)},on:{click:function(r){t.selectedOrder=e}}},[t._v(t._s(e))])})),0)])]),r("LessonsList",{attrs:{lessons:t.sortedLessons},on:{add:t.addToCart}}),r("Cart",{class:{showCart:t.isCartShown},attrs:{cart:t.cart,order:t.order},on:{displayCart:t.displayCart,increase:t.increaseQuantity,decrease:t.decreaseQuantity,remove:t.removeFromCart}})],1)},n=[],i=(r("159b"),r("a434"),r("d3b7"),r("99af"),r("b0c0"),r("b680"),r("fb6a"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"cart hideCart"},[r("div",{staticClass:"cart-content"},[r("button",{staticClass:"cart-btn close-cart",on:{click:function(e){return t.displayCart(!1)}}},[r("i",{staticClass:"fas fa-times"})]),r("div",{staticClass:"title"},[t._v("Total: £"+t._s(t.cartTotal))]),this.$parent.hasItemInCart?r("div",{staticClass:"cart-items"},[t._l(t.cart,(function(e,s){return r("div",{key:s,staticClass:"item"},[r("div",{staticClass:"name"},[r("img",{staticClass:"icon",attrs:{src:e.lesson.image}}),t._v(t._s(e.lesson.name))]),r("div",{staticClass:"location"},[t._v("in "+t._s(e.lesson.location))]),r("div",{staticClass:"price"},[r("span",{staticClass:"grayish"},[t._v(t._s(e.quantity)+" x")]),t._v(" £"+t._s(e.lesson.price))]),r("div",{staticClass:"quantity-selection"},[r("button",{on:{click:function(r){return t.decreaseQuantity(e)}}},[r("i",{staticClass:"fas fa-minus"})]),r("span",[t._v(t._s(e.quantity))]),r("button",{on:{click:function(r){return t.increaseQuantity(e)}}},[r("i",{staticClass:"fas fa-plus"})])]),r("div",{staticClass:"remove-link"},[r("a",{attrs:{href:""},on:{click:function(e){return t.removeFromCart(s,e)}}},[t._v("remove")])])])})),r("div",{staticClass:"checkoutform"},[r("h2",[t._v("Checkout")]),r("form",{attrs:{action:"",method:"POST"}},[r("div",{staticClass:"form-field"},[r("label",{attrs:{for:"name"}},[t._v("Name:")]),r("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.order.name.value,expression:"order.name.value",modifiers:{trim:!0}}],attrs:{type:"text",name:"name",placeholder:"Enter your name"},domProps:{value:t.order.name.value},on:{input:function(e){e.target.composing||t.$set(t.order.name,"value",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),r("span",{staticClass:"error"},[t._v(t._s(this.$parent.isValidName))])]),r("div",{staticClass:"form-field"},[r("label",{attrs:{for:"phone"}},[t._v("Phone:")]),r("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.order.phone.value,expression:"order.phone.value",modifiers:{trim:!0}}],attrs:{type:"text",name:"phone",placeholder:"Enter your phone number"},domProps:{value:t.order.phone.value},on:{input:function(e){e.target.composing||t.$set(t.order.phone,"value",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),r("span",{staticClass:"error"},[t._v(t._s(this.$parent.isValidPhone))])]),r("button",{attrs:{type:"button",disabled:!this.$parent.isValidCheckout},on:{click:this.$parent.checkout}},[t._v("Checkout")])])])],2):r("div",{staticClass:"cart-is-empty"},[r("div",{staticClass:"text"},[t._v("Your cart is empty.")]),r("button",{staticClass:"outline",on:{click:function(e){return t.displayCart(!1)}}},[t._v("View classes & activities")])])])])}),o=[],c={props:["cart","order"],name:"Cart",data:function(){return{}},methods:{displayCart:function(t){this.$emit("displayCart",t)},increaseQuantity:function(t){this.$emit("increase",t)},decreaseQuantity:function(t){this.$emit("decrease",t)},removeFromCart:function(t,e){e&&e.preventDefault(),this.$emit("remove",t)}},computed:{cartTotal:function(){return this.$parent.cartTotal}}},l=c,u=r("2877"),d=Object(u["a"])(l,i,o,!1,null,null,null),f=d.exports,v=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("main",t._l(t.lessons,(function(e,s){return r("div",{key:s,staticClass:"lesson"},[r("div",{staticClass:"lesson-wrapper"},[r("div",{staticClass:"image",style:{"background-image":"url("+e.image+")"}}),r("div",{staticClass:"info"},[r("div",{staticClass:"name"},[t._v(t._s(e.name))]),r("div",{staticClass:"location"},[t._v("in "+t._s(e.location))]),r("div",{staticClass:"avai-spaces"},[t._v("Spaces left: "+t._s(t.getAvailability(e)))]),r("div",{staticClass:"price"},[t._v("£"+t._s(e.price))]),r("button",{attrs:{disabled:t.isAvailable(e)},on:{click:function(r){return t.addToCart(e)}}},[t._v("Add to cart")])])])])})),0)},p=[],h={props:["lessons"],name:"LessonsList",methods:{addToCart:function(t){this.$emit("add",t)},getAvailability:function(t){return this.$parent.getAvailability(t)},isAvailable:function(t){return this.$parent.isAvailable(t)}}},m=h,y=Object(u["a"])(m,v,p,!1,null,"60c46ac9",null),C=y.exports,b={name:"App",components:{LessonsList:C,Cart:f},data:function(){return{sitename:"After school classes & activities",cart:[],lessons:[],cartShown:!1,filters:["name","location","price","availability"],orderBy:["ascending","descending"],selectedFilter:"name",selectedOrder:"ascending",order:{name:{value:"",error:!1,errorMessage:""},phone:{value:"",error:!1,errorMessage:""}}}},methods:{addToCart:function(t){var e=!1;this.cart.forEach((function(r){r.lesson==t&&(e=!0,r.quantity++)})),e||this.cart.push({lesson:t,quantity:1})},getAvailability:function(t){return t.availability-this.countInCart(t)},isAvailable:function(t){return this.getAvailability(t)<=0},countInCart:function(t){var e=0;return this.cart.forEach((function(r){r.lesson===t&&(e=r.quantity)})),e},removeFromCart:function(t){this.cart.splice(t,1)},isSelectedFilter:function(t){return t==this.selectedFilter},isSelectedOrder:function(t){return t==this.selectedOrder},decreaseQuantity:function(t){t.quantity>1&&t.quantity--},increaseQuantity:function(t){this.getAvailability(t.lesson)>=1&&t.quantity++},addOrder:function(t){var e=JSON.stringify(t);fetch("https://coursework2.herokuapp.com/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:e}).catch((function(t){return console.log(t)}))},updateLessonAvailability:function(t,e){fetch("https://coursework2.herokuapp.com/api/lessons/".concat(t,"/reduce/availability/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"}}).catch((function(t){return console.log(t)}))},checkout:function(){var t=this;this.cart.forEach((function(e){var r={name:t.order.name.value,phone:t.order.phone.value,lessonID:e.lesson._id,quantity:e.quantity};t.addOrder(r),t.updateLessonAvailability(e.lesson._id,e.quantity)})),alert("Thanks for your order"),this.getLessons(),this.cart=[]},displayCart:function(t){this.cartShown=t,t?document.body.classList.add("body-no-scroll"):document.body.classList.remove("body-no-scroll")},getLessons:function(){var t=this;fetch("https://coursework2.herokuapp.com/api/lessons").then((function(t){return t.json()})).then((function(e){return t.lessons=e})).catch((function(t){return console.log(t)}))}},computed:{cartCount:function(){return this.cart.length},hasItemInCart:function(){return!(this.cartCount<=0)},cartTotal:function(){var t=0;return this.cart.forEach((function(e){t+=e.lesson.price*e.quantity})),t.toFixed(2)},sortedLessons:function(){var t=this.lessons.slice(0),e=this;function r(t,r){return t[e.selectedFilter]>r[e.selectedFilter]?"ascending"==e.selectedOrder?1:-1:t[e.selectedFilter]<r[e.selectedFilter]?"ascending"==e.selectedOrder?-1:1:0}return t.sort(r)},isCartShown:function(){return this.cartShown},isValidCheckout:function(){return!this.order.name.error&&!this.order.phone.error},isValidName:function(){var t=this.order.name;if(t.value.length<=0)return t.error=!0,t.errorMessage="required",t.errorMessage;var e=/^[a-zA-Z ]+$/.test(t.value);return e?(t.error=!1,t.errorMessage="",t.errorMessage):(t.error=!0,t.errorMessage="only letters allowed",t.errorMessage)},isValidPhone:function(){var t=this.order.phone;if(t.value.length<=0)return t.error=!0,t.errorMessage="required",t.errorMessage;var e=/^\d+$/.test(t.value);return e?(t.error=!1,t.errorMessage="",t.errorMessage):(t.error=!0,t.errorMessage="only numbers allowed",t.errorMessage)}},mounted:function(){this.getLessons()}},g=b,_=Object(u["a"])(g,a,n,!1,null,null,null),k=_.exports;s["a"].config.productionTip=!1,new s["a"]({render:function(t){return t(k)}}).$mount("#app")}});
//# sourceMappingURL=app.09084616.js.map